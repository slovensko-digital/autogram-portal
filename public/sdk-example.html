<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AGP SDK Integration Example</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .section {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #e1e1e1;
            border-radius: 8px;
        }
        .button-group {
            margin: 20px 0;
        }
        .button-group button {
            margin-right: 10px;
            margin-bottom: 10px;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .primary {
            background-color: #007bff;
            color: white;
        }
        .secondary {
            background-color: #6c757d;
            color: white;
        }
        .danger {
            background-color: #dc3545;
            color: white;
        }
        .iframe-container {
            min-height: 400px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            color: #666;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
        }
        .config-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
            transition: border-color 0.2s;
            box-sizing: border-box;
        }
        .config-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
        }
        .config-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }
        .config-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        @media (max-width: 768px) {
            .config-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <h1>AGP SDK Integration Examples</h1>
    <p>This page demonstrates how to use the AGP SDK with both Contracts and Bundles in iframe and popup modes.</p>

    <!-- Configuration Section -->
    <div class="section">
        <h2>‚öôÔ∏è Configuration</h2>
        <p>Enter the Contract ID and Bundle ID you want to use for testing:</p>
        
        <div class="config-grid">
            <div>
                <label for="contract-id" class="config-label">Contract ID (UUID):</label>
                <input 
                    type="text" 
                    id="contract-id" 
                    class="config-input"
                    value="f512e1e4-9119-4b6e-a55e-5f3c40b1ae25" 
                    placeholder="Enter contract UUID"
                />
            </div>
            <div>
                <label for="bundle-id" class="config-label">Bundle ID (UUID):</label>
                <input 
                    type="text" 
                    id="bundle-id" 
                    class="config-input"
                    value="your-bundle-id" 
                    placeholder="Enter bundle UUID"
                />
            </div>
        </div>
        <p style="color: #666; font-size: 14px; margin-top: 10px;">
            üí° <strong>Tip:</strong> The IDs you enter here will be used by all the demo buttons below.
        </p>
    </div>

    <!-- Popup Mode Example - Contracts -->
    <div class="section">
        <h2>Contract Popup Mode</h2>
        <p>Opens a contract in a modal popup overlay</p>
        
        <div class="button-group">
            <button class="primary" onclick="openContractPopup()">Open Contract Popup</button>
            <button class="secondary" onclick="openContractPopupWithCallbacks()">Open Contract Popup with Callbacks</button>
            <button class="secondary" onclick="openContractPopupNoPreview()">Open Contract Popup (Sign Only)</button>
        </div>

        <h4>Usage:</h4>
        <pre><code>// Simple contract popup
agp.initContractIframe('your-contract-id', {
    mode: 'popup'
});

// Contract popup with custom options
agp.initContractIframe('your-contract-id', {
    mode: 'popup',
    popupWidth: 1200,
    popupHeight: 900,
    popupTitle: 'Sign Contract',
    onMessage: (data, origin, iframe) => console.log('Message:', data),
    onClose: () => console.log('Popup closed')
});

// Backward compatible (uses initIframe - same as initContractIframe)
agp.initIframe('your-contract-id', {
    mode: 'popup'
});</code></pre>
    </div>

    <!-- Popup Mode Example - Bundles -->
    <div class="section">
        <h2>Bundle Popup Mode</h2>
        <p>Opens a bundle (multiple contracts) in a modal popup overlay</p>
        
        <div class="button-group">
            <button class="primary" onclick="openBundlePopup()">Open Bundle Popup</button>
            <button class="secondary" onclick="openBundlePopupWithCallbacks()">Open Bundle Popup with Callbacks</button>
            <button class="secondary" onclick="openBundlePopupNoPreview()">Open Bundle Popup (Sign Only)</button>
        </div>

        <h4>Usage:</h4>
        <pre><code>// Simple bundle popup
agp.initBundleIframe('your-bundle-id', {
    mode: 'popup'
});

// Bundle popup with custom options
agp.initBundleIframe('your-bundle-id', {
    mode: 'popup',
    popupWidth: 1200,
    popupHeight: 900,
    popupTitle: 'Sign Bundle',
    onMessage: (data, origin, iframe) => console.log('Message:', data),
    onClose: () => console.log('Popup closed')
});</code></pre>
    </div>

    <!-- Iframe Mode with Parent Element -->
    <div class="section">
        <h2>Iframe Mode with Parent Element</h2>
        <p>Embeds AGP portal as an iframe within a specific container</p>
        
        <div class="button-group">
            <button class="primary" onclick="embedContractInContainer()">Embed Contract in Container</button>
            <button class="primary" onclick="embedBundleInContainer()">Embed Bundle in Container</button>
            <button class="secondary" onclick="embedContractNoPreview()">Embed Contract (Sign Only)</button>
            <button class="secondary" onclick="embedBundleNoPreview()">Embed Bundle (Sign Only)</button>
            <button class="danger" onclick="clearContainer()">Clear Container</button>
        </div>

        <div id="agp-container" class="iframe-container">
            <p>Container for AGP iframe - click a button above to load</p>
        </div>

        <h4>Usage:</h4>
        <pre><code>// Embed contract in specific element
agp.initContractIframe('your-contract-id', {
    mode: 'iframe',
    parentElement: '#agp-container', // or document.getElementById('agp-container')
    width: '100%',
    height: '600px'
});

// Embed bundle in specific element
agp.initBundleIframe('your-bundle-id', {
    mode: 'iframe',
    parentElement: '#agp-container',
    width: '100%',
    height: '600px'
});</code></pre>
    </div>

    <!-- Advanced Usage -->
    <div class="section">
        <h2>Advanced Usage</h2>
        
        <div class="button-group">
            <button class="danger" onclick="destroyAll()">Destroy All Instances</button>
        </div>

        <h4>Available Methods:</h4>
        <pre><code>// Contract-specific method
agp.initContractIframe(contractId, options)

// Bundle-specific method
agp.initBundleIframe(bundleId, options)

// Backward compatible method (same as initContractIframe)
agp.initIframe(contractId, options)</code></pre>

        <h4>Available Options:</h4>
        <pre><code>agp.initContractIframe('contract-id', {
    mode: 'iframe' | 'popup',           // Integration mode
    parentElement: '#selector' | element, // Parent element for iframe mode
    noPreview: false,                   // Set to true to show only sign button
    width: '100%',                      // iframe width
    height: '800px',                    // iframe height
    border: 'solid 1px #ccc',          // iframe border
    baseUrl: 'http://localhost:3000',   // AGP base URL
    popupWidth: 800,                    // Popup width in pixels
    popupHeight: 600,                   // Popup height in pixels
    popupTitle: 'AGP Portal',           // Popup title
    onMessage: function(data, origin, iframe) {}, // Message handler
    onClose: function() {}              // Close handler (popup only)
});</code></pre>

        <h4>Return Value:</h4>
        <pre><code>// Iframe mode returns:
{
    iframe: HTMLIFrameElement,
    destroy: function() // Remove iframe
}

// Popup mode returns:
{
    popup: HTMLDivElement,
    iframe: HTMLIFrameElement,
    close: function(), // Close popup
    destroy: function() // Same as close
}</code></pre>
    </div>

    <script src="sdk.js"></script>
    <script>
        let currentInstance = null;

        // Helper functions to get IDs from input fields
        function getContractId() {
            return document.getElementById('contract-id').value.trim();
        }

        function getBundleId() {
            return document.getElementById('bundle-id').value.trim();
        }

        function validateId(id, type) {
            if (!id) {
                alert(`Please enter a ${type} ID in the configuration section above.`);
                return false;
            }
            return true;
        }

        // Contract Popup Functions
        function openContractPopup() {
            const contractId = getContractId();
            if (!validateId(contractId, 'Contract')) return;
            
            currentInstance = agp.initContractIframe(contractId, {
                mode: 'popup',
                popupWidth: 1200,
                popupHeight: 900,
                popupTitle: 'Sign Contract'
            });
        }

        function openContractPopupWithCallbacks() {
            const contractId = getContractId();
            if (!validateId(contractId, 'Contract')) return;
            
            currentInstance = agp.initContractIframe(contractId, {
                mode: 'popup',
                popupWidth: 1200,
                popupHeight: 900,
                popupTitle: 'Sign Contract - Custom',
                onMessage: (data, origin, iframe) => {
                    console.log('Contract message:', data);
                },
                onClose: () => {
                    console.log('Contract popup was closed');
                    currentInstance = null;
                }
            });
        }

        function openContractPopupNoPreview() {
            const contractId = getContractId();
            if (!validateId(contractId, 'Contract')) return;
            
            currentInstance = agp.initContractIframe(contractId, {
                mode: 'popup',
                noPreview: true,
                popupTitle: 'Sign Contract',
                popupWidth: 500,
                popupHeight: 600,
                onClose: () => {
                    console.log('Contract sign-only popup was closed');
                    currentInstance = null;
                }
            });
        }

        // Bundle Popup Functions
        function openBundlePopup() {
            const bundleId = getBundleId();
            if (!validateId(bundleId, 'Bundle')) return;
            
            currentInstance = agp.initBundleIframe(bundleId, {
                mode: 'popup',
                popupWidth: 1200,
                popupHeight: 900,
                popupTitle: 'Sign Bundle'
            });
        }

        function openBundlePopupWithCallbacks() {
            const bundleId = getBundleId();
            if (!validateId(bundleId, 'Bundle')) return;
            
            currentInstance = agp.initBundleIframe(bundleId, {
                mode: 'popup',
                popupWidth: 1200,
                popupHeight: 900,
                popupTitle: 'Sign Bundle - Custom',
                onMessage: (data, origin, iframe) => {
                    console.log('Bundle message:', data);
                },
                onClose: () => {
                    console.log('Bundle popup was closed');
                    currentInstance = null;
                }
            });
        }

        function openBundlePopupNoPreview() {
            const bundleId = getBundleId();
            if (!validateId(bundleId, 'Bundle')) return;
            
            currentInstance = agp.initBundleIframe(bundleId, {
                mode: 'popup',
                noPreview: true,
                popupTitle: 'Sign Bundle',
                popupWidth: 500,
                popupHeight: 600,
                onClose: () => {
                    console.log('Bundle sign-only popup was closed');
                    currentInstance = null;
                }
            });
        }

        // Iframe Embed Functions
        function embedContractInContainer() {
            const contractId = getContractId();
            if (!validateId(contractId, 'Contract')) return;
            
            clearContainer();
            currentInstance = agp.initContractIframe(contractId, {
                mode: 'iframe',
                parentElement: '#agp-container',
                height: '500px',
                onMessage: (data, origin, iframe) => {
                    console.log('Contract iframe message:', data);
                }
            });
        }

        function embedBundleInContainer() {
            const bundleId = getBundleId();
            if (!validateId(bundleId, 'Bundle')) return;
            
            clearContainer();
            currentInstance = agp.initBundleIframe(bundleId, {
                mode: 'iframe',
                parentElement: '#agp-container',
                height: '500px',
                onMessage: (data, origin, iframe) => {
                    console.log('Bundle iframe message:', data);
                }
            });
        }

        function embedContractNoPreview() {
            const contractId = getContractId();
            if (!validateId(contractId, 'Contract')) return;
            
            clearContainer();
            currentInstance = agp.initContractIframe(contractId, {
                mode: 'iframe',
                parentElement: '#agp-container',
                noPreview: true,
                height: '500px',
                onMessage: (data, origin, iframe) => {
                    console.log('Contract sign-only iframe message:', data);
                }
            });
        }

        function embedBundleNoPreview() {
            const bundleId = getBundleId();
            if (!validateId(bundleId, 'Bundle')) return;
            
            clearContainer();
            currentInstance = agp.initBundleIframe(bundleId, {
                mode: 'iframe',
                parentElement: '#agp-container',
                noPreview: true,
                height: '500px',
                onMessage: (data, origin, iframe) => {
                    console.log('Bundle sign-only iframe message:', data);
                }
            });
        }

        function clearContainer() {
            const container = document.getElementById('agp-container');
            container.innerHTML = '<p>Container for AGP iframe - click a button above to load</p>';
            if (currentInstance && currentInstance.destroy) {
                currentInstance.destroy();
                currentInstance = null;
            }
        }

        function destroyAll() {
            agp.destroyAll();
            clearContainer();
            currentInstance = null;
        }

        // Example of handling messages globally
        window.addEventListener('message', function(event) {
            if (event.data && event.data.type === 'agp-custom-event') {
                console.log('Received custom AGP event:', event.data);
            }
        });
    </script>
</body>
</html>